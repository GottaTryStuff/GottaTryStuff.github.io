<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<script type="text/javascript" src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836"></script><script type="text/javascript">
					function OptanonWrapper() { }
				</script><script>var offline=(location.href.indexOf('docs.unity3d.com')==-1)?true:false;if(!offline){(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-5V25JL6');}</script><link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual:  General Optimizations</title>
<meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="https://docs.unity3d.com/StaticFilesConfig/UnityVersionsInfo.js"></script><script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=1609815866"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=1609815866"></script><script type="text/javascript" src="docdata/toc.js?ts=1609815866"></script><script type="text/javascript" src="docdata/global_toc.js?ts=1609815866"></script><link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=1609815866">
<link rel="stylesheet" href="../StaticFilesManual/css/prism.css">
<script src="../StaticFilesManual/js/prism.js"></script><script src="/StaticFilesConfig/feedback/feedback.js"></script><script src="../StaticFilesManual/js/jquery.sidebar.min.js"></script><link rel="stylesheet" href="../StaticFilesManual/css/mobileoptimisation.css">
<script src="../StaticFilesManual/js/mobileoptimisation.js"></script>
</head>
<body>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div id="DocsAnalyticsData" data-area="core" data-pagetype="manual"></div>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity.com/">unity3d.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="toggle version-number" id="VersionNumber" data-target=".otherversionscontent">
                                Version: <b>2019.4</b><div class="otherversionscontent" id="OtherVersionsContent" style="display: none;">
<ul id="OtherVersionsContentUl"></ul>
<div id="otherVersionsLegend"><ul>
<li>
<div id="supportedColour" class="legendBox"></div>Supported</li>
<li>
<div id="notFoundColour" class="legendBox"></div>Legacy</li>
</ul></div>
</div>
<div id="VersionSwitcherArrow" class="arrow versionSwitcherArrow"></div>
</div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">English</a></li>
<li><a href="/cn/current/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">中文</a></li>
<li><a href="/ja/current/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">日本語</a></li>
<li><a href="/es/current/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">Español</a></li>
<li><a href="/kr/current/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">한국어</a></li>
<li><a href="/ru/current/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">Русский</a></li>
</ul></div>
</div></div>
</div></div>
<div class="mobileLogo"><a href="https://docs.unity3d.com"></a></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc" id="customScrollbar">
<h2>Unity Manual</h2>
<div class="search-form sidebar-search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" id="mobileSearchBtn" class="submit" value="Search">
</form></div>
<div class="toggle version-number sidebar-version-switcher" id="VersionNumber" data-target=".otherversionscontent"><form id="otherVersionsContentMobileForm"><div class="ui-field-contain">
<label for="select-native-4">Version: 2019.4</label><select name="select-native-4" id="versionsSelectMobile"><option>Select a different version</option>
<optgroup id="versionsWithThisPageMobile" label="Versions with this page"></optgroup>
<optgroup id="versionsWithoutThisPageMobile" label="Versions without this page"></optgroup></select>
</div></form></div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">English</a></li>
<li><a href="/cn/current/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">中文</a></li>
<li><a href="/ja/current/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">日本語</a></li>
<li><a href="/es/current/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">Español</a></li>
<li><a href="/kr/current/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">한국어</a></li>
<li><a href="/ru/current/Manual/BestPracticeUnderstandingPerformanceInUnity7.html">Русский</a></li>
</ul></div>
</div></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html"> Unity User Manual (2019.4 LTS)</a></li>
<li><a href="UnityOverview.html"> Working in Unity</a></li>
<li><a href="analysis.html"> Analysis</a></li>
<li><a href="BestPracticeUnderstandingPerformanceInUnity.html"> Understanding optimization in Unity</a></li>
<li> General Optimizations</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="BestPracticeUnderstandingPerformanceInUnity6.html"></a></span><div class="tip"> The Resources folder</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="BestPracticeUnderstandingPerformanceInUnity8.html"></a></span><div class="tip"> Special optimizations</div>
</div>
</div></div>
<div id="_leavefeedback"></div>
<h1>General Optimizations</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>There are as many different ways to optimize code as there are reasons for performance problems. In general, it is strongly recommended that developers closely profile their applications before attempting to apply CPU optimizations. However, there are several simple CPU optimizations that are universally applicable.</p>

<h2>Address Properties by ID</h2>

<p>Unity does not use string names to address Animator, Material and <span class="tooltip"><strong>Shader</strong><span class="tooltiptext">A small script that contains the mathematical calculations and algorithms for calculating the Color of each pixel rendered, based on the lighting input and the Material configuration. <a class="tooltipMoreInfoLink" href="Shaders.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Shader">Glossary</a></span></span></span> properties internally. For speed, all property names are hashed into property IDs, and it is these IDs that are actually used to address the properties.</p>

<p>Therefore, whenever using a <em>Set</em> or <em>Get</em> method on an Animator, Material or Shader, use the integer-valued method instead of the string-valued methods. The string methods simply perform string hashing and then forward the hashed ID to the integer-valued methods.</p>

<p>The property IDs created from string hashes are deterministic over the course of a single run. The simplest way to use them is to declare a static read-only integer variable for each property name, and use the integer variable in place of the string. These are automatically initialized during startup with no further initialization code needed.</p>

<p>The appropriate APIs are <a href="../ScriptReference/Animator.StringToHash.html">Animator.StringToHash</a> for Animator property names, and <a href="../ScriptReference/Shader.PropertyToID.html">Shader.PropertyToID</a> for Material &amp; Shader property names.</p>

<h2>Use non-allocating physics APIs</h2>

<p>In Unity 5.3 and onwards, non-allocating versions of all Physics query APIs have been introduced. Replace <a href="../ScriptReference/Physics.RaycastAll.html">RaycastAll</a> calls with <a href="../ScriptReference/Physics.RaycastNonAlloc.html">RaycastNonAlloc</a>, <a href="../ScriptReference/Physics.SphereCastAll.html">SphereCastAll</a> calls with <a href="../ScriptReference/Physics.SphereCastNonAlloc.html">SphereCastNonAlloc</a>, and so on. For 2D applications, there are also non-allocating versions of all Physics2D query APIs.</p>

<h2>Null comparisons against UnityEngine.Object subclasses</h2>

<p>The Mono and <span class="tooltip"><strong>IL2CPP</strong><span class="tooltiptext">A Unity-developed scripting back-end which you can use as an alternative to Mono when building projects for some platforms. <a class="tooltipMoreInfoLink" href="IL2CPP.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#IL2CPP">Glossary</a></span></span></span> runtimes treat instances of classes that derive from <a href="../ScriptReference/Object.html">UnityEngine.Object</a> in a specific way. Invoking methods on the instances actually calls into engine code, which must perform lookups and validations to convert the script references to the native references. While small, the cost of comparing a variable of this type to null is much more expensive than a comparison against a purely C# class. For this reason, avoid these null comparisons in tight loops or in code that runs every frame.</p>

<h3>Vector and quaternion math and order of operations</h3>

<p>For vector and <span class="tooltip"><strong>quaternion</strong><span class="tooltiptext">Unity’s standard way of representing rotations as data. When writing code that deals with rotations, you should usually use the Quaternion class and its methods. <a class="tooltipMoreInfoLink" href="QuaternionAndEulerRotationsInUnity.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Quaternion">Glossary</a></span></span></span> math that is located in tight loops, remember that integer math is faster than floating-point math, and floating-point math is faster than vector, matrix or <strong>quaternion</strong> math.</p>

<p>Therefore, whenever commutative or associative arithmetic allows, attempt to minimize the cost of individual mathematical operations:</p>

<pre><code>
Vector3 x;

int a, b;

// Less efficient: results in two vector multiplications

Vector3 slow = a * x * b;

// More efficient: one integer mult, one vector mult

Vector3 fast = a * b * x;

</code></pre>

<h2>Built-In ColorUtility</h2>

<p>It is common for applications that must convert between HTML-formatted color strings (<code>#RRGGBBAA</code>) and Unity’s native <code>Color</code> and <code>Color32</code> structures to use a script from the Unify Community. This script was both slow and caused extensive memory allocation due to string manipulation.</p>

<p>As of Unity 5, there is a built-in <a href="../ScriptReference/ColorUtility.html">ColorUtility</a> API that performs these conversions efficiently. Usage of the built-in API should be preferred.</p>

<h2>Find and FindObjectOfType</h2>

<p>It is a general best practice to eliminate all usage of <code>Object.Find</code> and <code>Object.FindObjectOfType</code> in production code. As these APIs require Unity to iterate over all <span class="tooltip"><strong>GameObjects</strong><span class="tooltiptext">The fundamental object in Unity scenes, which can represent characters, props, scenery, cameras, waypoints, and more. A GameObject’s functionality is defined by the Components attached to it. <a class="tooltipMoreInfoLink" href="class-GameObject.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#GameObject">Glossary</a></span></span></span> and Components in memory, they rapidly become non-performant as the scope of a project grows.</p>

<p>An exception to the above rule can be made in accessors for singleton objects. A global manager object often exposes an “instance” property, and often has a <code>FindObjectOfType</code> call in the getter to detect pre-existing instances of the singleton:</p>

<pre><code>
class SomeSingleton {

    private SomeSingleton _instance;

    public SomeSingleton Instance {

        get {

            if(_instance == null) { 

                _instance =

                    FindObjectOfType&lt;SomeSingleton&gt;(); 

            }

            if(_instnace == null) { 

                _instance = CreateSomeSingleton();

            }

            return _instance;

        }

    }

}

</code></pre>

<p>While this pattern is generally acceptable, it is important to examine the code and ensure that the accessor is be called in <span class="tooltip"><strong>Scenes</strong><span class="tooltiptext">A Scene contains the environments and menus of your game. Think of each unique Scene file as a unique level. In each Scene, you place your environments, obstacles, and decorations, essentially designing and building your game in pieces. <a class="tooltipMoreInfoLink" href="CreatingScenes.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Scene">Glossary</a></span></span></span> where the singleton object does not exist. If the getter does not automatically create an instance of a missing singleton, it is very common to discover that code looking for the singleton results in repeated calls to <code>FindObjectOfType</code> (often multiple times per frame) and creates an undesirable drain on performance.</p>

<h3>Camera locators</h3>

<p>Internally, Unity’s <code>Camera.main</code> property calls <code>Object.FindObjectWithTag</code>, a specialized variant of <code>Object.FindObject</code>. Accessing this property is no more efficient than a call to <code>Object.FindObjectOfType</code>. If code must address the main <span class="tooltip"><strong>camera</strong><span class="tooltiptext">A component which creates an image of a particular viewpoint in your scene. The output is either drawn to the screen or captured as a texture. <a class="tooltipMoreInfoLink" href="CamerasOverview.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Camera">Glossary</a></span></span></span>, it is strongly recommended to do one of two things:</p>

<ul>
<li><p>Access <code>Camera.main</code> in a <code>Start</code> or<code>OnEnable</code> callback and cache the resulting reference.</p></li>
<li><p>Construct a <code>Camera Manager</code> class that can provide or inject a reference to the active camera.</p></li>
</ul>

<h2>Debug code &amp; the [conditional] attribute</h2>

<p>The <code>UnityEngine.Debug</code> logging APIs are not stripped from non-development builds, and do write to log files if called. As most developers do not intend to write debug information in non-development builds, it is recommended to wrap development-only logging calls in custom methods, like so:</p>

<pre><code>
    public static class Logger {

        [Conditional(&quot;ENABLE_LOGS&quot;)]

        public static void Debug(string logMsg) {

            UnityEngine.Debug.Log(logMsg);

        }

    }

</code></pre>

<p>By decorating these methods with the [Conditional] attribute, the define or defines used by the Conditional attribute determine whether the decorated method is included in the compiled source.</p>

<p>If none of the defines passed to the Conditional attribute are defined, then the decorated method <em>and</em> all calls to the decorated method are compiled out. The effect is identical to what would happen if the method and all calls to the method were wrapped in <code>#if … #endif</code> preprocessor blocks.</p>

<p>For more information on the <code>Conditional</code> attribute, see the MSDN website: <a href="https://msdn.microsoft.com/en-us/library/4xssyw96(v=vs.90).aspx">msdn.microsoft.com</a>.</p>
<!-- area:core -->
<div id="_content"></div>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="BestPracticeUnderstandingPerformanceInUnity6.html"></a></span><div class="tip"> The Resources folder</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="BestPracticeUnderstandingPerformanceInUnity8.html"></a></span><div class="tip"> Special optimizations</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">Copyright © 2020 Unity Technologies. Publication Date: 2021-01-05.</div>
<div class="menu">
<a href="https://learn.unity.com/">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
